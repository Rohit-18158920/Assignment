{"ast":null,"code":"import { __assign } from \"tslib\";\nimport { GlobalSettings } from '../GlobalSettings';\nvar CustomizationsGlobalKey = 'customizations';\nvar NO_CUSTOMIZATIONS = {\n  settings: {},\n  scopedSettings: {},\n  inCustomizerContext: false\n};\n\nvar _allSettings = GlobalSettings.getValue(CustomizationsGlobalKey, {\n  settings: {},\n  scopedSettings: {},\n  inCustomizerContext: false\n});\n\nvar _events = [];\n\nvar Customizations =\n/** @class */\nfunction () {\n  function Customizations() {}\n\n  Customizations.reset = function () {\n    _allSettings.settings = {};\n    _allSettings.scopedSettings = {};\n  };\n  /** Apply global Customization settings.\n   * @example Customizations.applySettings(\\{ theme: \\{...\\} \\});\n   */\n\n\n  Customizations.applySettings = function (settings) {\n    _allSettings.settings = __assign(__assign({}, _allSettings.settings), settings);\n\n    Customizations._raiseChange();\n  };\n  /** Apply Customizations to a particular named scope, like a component.\n   * @example Customizations.applyScopedSettings('Nav', \\{ styles: () =\\> \\{\\} \\});\n   */\n\n\n  Customizations.applyScopedSettings = function (scopeName, settings) {\n    _allSettings.scopedSettings[scopeName] = __assign(__assign({}, _allSettings.scopedSettings[scopeName]), settings);\n\n    Customizations._raiseChange();\n  };\n\n  Customizations.getSettings = function (properties, scopeName, localSettings) {\n    if (localSettings === void 0) {\n      localSettings = NO_CUSTOMIZATIONS;\n    }\n\n    var settings = {};\n    var localScopedSettings = scopeName && localSettings.scopedSettings[scopeName] || {};\n    var globalScopedSettings = scopeName && _allSettings.scopedSettings[scopeName] || {};\n\n    for (var _i = 0, properties_1 = properties; _i < properties_1.length; _i++) {\n      var property = properties_1[_i];\n      settings[property] = localScopedSettings[property] || localSettings.settings[property] || globalScopedSettings[property] || _allSettings.settings[property];\n    }\n\n    return settings;\n  };\n  /** Used to run some code that sets Customizations without triggering an update until the end.\n   * Useful for applying Customizations that don't affect anything currently rendered, or for\n   * applying many customizations at once.\n   * @param suppressUpdate - Do not raise the change event at the end, preventing all updates\n   */\n\n\n  Customizations.applyBatchedUpdates = function (code, suppressUpdate) {\n    Customizations._suppressUpdates = true;\n\n    try {\n      code();\n    } catch (_a) {\n      /* do nothing */\n    }\n\n    Customizations._suppressUpdates = false;\n\n    if (!suppressUpdate) {\n      Customizations._raiseChange();\n    }\n  };\n\n  Customizations.observe = function (onChange) {\n    _events.push(onChange);\n  };\n\n  Customizations.unobserve = function (onChange) {\n    _events = _events.filter(function (cb) {\n      return cb !== onChange;\n    });\n  };\n\n  Customizations._raiseChange = function () {\n    if (!Customizations._suppressUpdates) {\n      _events.forEach(function (cb) {\n        return cb();\n      });\n    }\n  };\n\n  return Customizations;\n}();\n\nexport { Customizations };","map":{"version":3,"sources":["customizations/Customizations.ts"],"names":[],"mappings":"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","sourcesContent":["import { GlobalSettings } from '../GlobalSettings';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type ISettings = { [key: string]: any };\nexport type ISettingsFunction = (settings: ISettings) => ISettings;\n\n/**\n * @deprecated Use ISettings.\n */\nexport type Settings = ISettings;\n\n/**\n * @deprecated Use ISettingsFunction.\n */\nexport type SettingsFunction = ISettingsFunction;\n\nexport interface ICustomizations {\n  settings: ISettings;\n  scopedSettings: { [key: string]: ISettings };\n  inCustomizerContext?: boolean;\n}\n\nconst CustomizationsGlobalKey = 'customizations';\nconst NO_CUSTOMIZATIONS = { settings: {}, scopedSettings: {}, inCustomizerContext: false };\n\nlet _allSettings = GlobalSettings.getValue<ICustomizations>(CustomizationsGlobalKey, {\n  settings: {},\n  scopedSettings: {},\n  inCustomizerContext: false,\n});\n\nlet _events: (() => void)[] = [];\n\nexport class Customizations {\n  private static _suppressUpdates: boolean;\n\n  public static reset(): void {\n    _allSettings.settings = {};\n    _allSettings.scopedSettings = {};\n  }\n\n  /** Apply global Customization settings.\n   * @example Customizations.applySettings(\\{ theme: \\{...\\} \\});\n   */\n  public static applySettings(settings: ISettings): void {\n    _allSettings.settings = { ..._allSettings.settings, ...settings };\n    Customizations._raiseChange();\n  }\n\n  /** Apply Customizations to a particular named scope, like a component.\n   * @example Customizations.applyScopedSettings('Nav', \\{ styles: () =\\> \\{\\} \\});\n   */\n  public static applyScopedSettings(scopeName: string, settings: ISettings): void {\n    _allSettings.scopedSettings[scopeName] = { ..._allSettings.scopedSettings[scopeName], ...settings };\n    Customizations._raiseChange();\n  }\n\n  public static getSettings(\n    properties: string[],\n    scopeName?: string,\n    localSettings: ICustomizations = NO_CUSTOMIZATIONS,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ): any {\n    const settings: ISettings = {};\n    const localScopedSettings = (scopeName && localSettings.scopedSettings[scopeName]) || {};\n    const globalScopedSettings = (scopeName && _allSettings.scopedSettings[scopeName]) || {};\n\n    for (let property of properties) {\n      settings[property] =\n        localScopedSettings[property] ||\n        localSettings.settings[property] ||\n        globalScopedSettings[property] ||\n        _allSettings.settings[property];\n    }\n\n    return settings;\n  }\n\n  /** Used to run some code that sets Customizations without triggering an update until the end.\n   * Useful for applying Customizations that don't affect anything currently rendered, or for\n   * applying many customizations at once.\n   * @param suppressUpdate - Do not raise the change event at the end, preventing all updates\n   */\n  public static applyBatchedUpdates(code: () => void, suppressUpdate?: boolean): void {\n    Customizations._suppressUpdates = true;\n    try {\n      code();\n    } catch {\n      /* do nothing */\n    }\n    Customizations._suppressUpdates = false;\n    if (!suppressUpdate) {\n      Customizations._raiseChange();\n    }\n  }\n\n  public static observe(onChange: () => void): void {\n    _events.push(onChange);\n  }\n\n  public static unobserve(onChange: () => void): void {\n    _events = _events.filter((cb: () => void) => cb !== onChange);\n  }\n\n  private static _raiseChange(): void {\n    if (!Customizations._suppressUpdates) {\n      _events.forEach((cb: () => void) => cb());\n    }\n  }\n}\n"],"sourceRoot":"../src/"},"metadata":{},"sourceType":"module"}